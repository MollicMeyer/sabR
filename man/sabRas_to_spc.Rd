% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sabRas_to_spc.R
\name{sabRas_to_spc}
\alias{sabRas_to_spc}
\title{Convert Raster Stack to SoilProfileCollection and Aggregate to Standard Depths}
\usage{
sabRas_to_spc(
  rstack,
  props = c("sand", "clay", "silt", "TOC", "BD"),
  depths = c("0-5", "5-15", "15-30", "30-60", "60-100", "100-150", "150-200"),
  new_depths = c(0, 5, 15, 30, 60, 100, 150, 200),
  source = "SABR"
)
}
\arguments{
\item{rstack}{A \code{SpatRaster} object where layer names follow the pattern \code{property_depth}, e.g., \code{sand_0-5}.}

\item{props}{Character vector of soil properties to include. Must be in the allowed list.}

\item{depths}{Character vector of raster depth intervals to include. Must be subset of:
\code{"0-5"}, \code{"5-15"}, \code{"15-30"}, \code{"30-60"}, \code{"60-100"}, \code{"100-150"}, \code{"150-200"}.}

\item{new_depths}{Numeric vector of standard depths (in cm) to aggregate to, e.g., \code{c(0, 5, 15, 30, 60, 100, 150, 200)}.}

\item{source}{Optional character string appended to profile IDs (e.g., \code{"SABR"}) to prevent overlap across sources.}
}
\value{
A \code{SoilProfileCollection} object aggregated to the specified \code{new_depths}.
}
\description{
Converts a stack of soil property rasters into an \code{aqp::SoilProfileCollection} object,
then aggregates values to user-defined standard depth intervals.
}
\details{
\itemize{
\item This function requires that raster layer names follow the pattern \code{"property_depth"}, e.g., \code{"clay_5-15"}.
\item \code{depths} specifies which original raster depth intervals to include.
\item \code{new_depths} specifies the target output horizon structure (e.g., 0â€“30cm in 3 layers).
\item Each raster pixel becomes a profile, with spatial coordinates retained in \code{site()}.
\item Internally, raster values are reshaped, converted to SPC, diced to 1cm slices, and re-aggregated using means.
}
}
